{% macro textinput(
form,
id="",
class_="",
placeholder="",
prefix="",
suffix="",
disabled=False,
readonly=False,
required=False,
disabled_optional_text=True,
**kwargs
) %}
{# Base input styling #}
{% set style = "input flex items-center gap-2 w-full" %}

{# Apply error styling if there are validation errors #}
{% if form.errors | count > 0 %}
{% set style = style + " input-error" %}
{% endif %}

{# Append additional custom classes if provided #}
{% if class_ %}
{% set style = style + " " + class_ %}
{% endif %}

{# Handle hidden fields separately #}
{% if form.type == "HiddenField" %}
{{ form(**kwargs) }}
{% else %}
<fieldset class="w-full fieldset" id="field-{{ form.id }}">
  <legend class="fieldset-legend">
    {{ form.label.text }}

    {# Required field indicator #}
    {% if form.flags.required or required %}
    <span class="text-error">*</span>
    {% endif %}

    {# Show "optional" text if the field is not required #}
    {% if not form.flags.required and not disabled_optional_text %}
    <p class="fieldset-label">(ไม่บังคับ)</p>
    {% endif %}
  </legend>

  <label class="w-full input {% if readonly %}input-readonly{% endif %}">
    {# Prefix (if available) #}
    {% if prefix %}
    {{ prefix }}
    {% endif %}

    {# Render the input field with placeholder, styles, and additional attributes #}
    {{ form(placeholder=placeholder, readonly=readonly, class_=style, **kwargs) }}

    {# Suffix (if available) #}
    {% if suffix %}
    {{ suffix }}
    {% endif %}
  </label>

  {# Display validation errors #}
  <p class="validator-hint">
    {% for error in form.errors %}
    {% if 'This field is required' in error %}
    กรุณากรอกข้อมูล
    {% else %}
    {{ error }}
    {% endif %}
    {% if not loop.last %}<br>{% endif %}
    {% endfor %}
  </p>
</fieldset>
{% endif %}
{% endmacro %}